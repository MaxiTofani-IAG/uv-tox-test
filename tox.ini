# ðŸš€ TOX AVANZADO ADAPTADO PARA UV - Con coverage y linting

[tox]
envlist = py312

[testenv]
# âœ… ADAPTADO: extras en lugar de requirements.txt
extras = test
deps =
    pytest-cov
setenv =
    PYTHONPATH = {toxinidir}
    PYTHONUNBUFFERED = yes
    MESSAGE_AFTER_COMPUTATION_DELAY = 0
commands =
    pytest {posargs:tests} -ra --cov=app --cov-report=xml --cov-report=html --cov-report=term-missing

[coverage:run]
relative_files = True
source = .
omit =
    tests/*
    */__init__.py

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise NotImplementedError
    if __name__ == "__main__":
    pass
    raise ImportError

[coverage:html]
directory = htmlcov

[testenv:lint]
skip_install = true
deps = flake8
commands = flake8 app.py tests

[testenv:format]
skip_install = true
deps = black
commands = black --check app.py tests

[testenv:run]
description = Ejecutar FastAPI app
commands = 
    uvicorn app:app --reload --port 8000
